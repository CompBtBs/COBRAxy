<tool id="MaREA RPS Generator" name="Expression2RPS" version="2.0.0">
    <description>- Reaction Propensity Scores computation</description>
    <macros>
        <import>marea_macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="1.24.4">numpy</requirement>
        <requirement type="package" version="2.0.3">pandas</requirement>
        <requirement type="package" version="5.2.2">lxml</requirement>
		<requirement type="package" version="0.29.0">cobra</requirement>
	</requirements>
    <command detect_errors="exit_code">
        <![CDATA[
      	python $__tool_directory__/rps_generator.py
        --input $input	
        --tool_dir $__tool_directory__
        --out_log $log	
        --rps_output $rps_output
        --model_upload $model_upload
        --dict_rps_output $dict_rps_output
        ]]>
    </command>
    <inputs> 
        <param name="model_upload" argument="--model_upload" type="data" format="csv,tsv,tabular" 
                label="Model tabular:" help="Upload a CSV/TSV file containing reaction rules generated by the Import Metabolic Model tool." />

        <param name="input" argument="--input" type="data" format="tabular, tsv, csv" label="Intracellular metabolomics dataset:" />
        <param name="name" argument="--name" type="text" label="Dataset's name:" value="Dataset_RPS" help="Default: Dataset_RPS. Do not use white spaces or special symbols." />
    </inputs>

    <outputs>
        <data format="txt" name="log" label="Expression2RPS - $name - Log" />
        <data format="tabular" name="rps_output" label="$name"/>
        <data format="tabular" name="dict_rps_output" label="$name"/>
    </outputs>

    <help>
<![CDATA[

Overview
-------------

This tool computes Reaction Propensity Scores (RPS) based on the availability of reaction substrates, for (ideally) each input model reaction and for each sample. 

The tool has four input parameters:
    - Metabolic model: tabular file containing information (reactionID and reaction formula) for RPS computation (see TIP 1)
    - An abundance dataset: Tab-separated text file reporting the abundance value (either relative or absolute) of each measured metabolite for each cell line in the dataset. 
                            Column header: cell line ID. 
                            Row header: metabolite ID.    

**TIP 1** The model tabular file can be the one obtained from Import Metabolic Model tool or can be a custom file BUT in the same format. 

Output:
-------------

The tool generates:
    - a tab-separated file(.csv): reporting the RPS values for each reaction and each cell line in the dataset.
    - a tab-separated file(.csv): reporting the mapping between the metabolite IDs in the input file and the corresponding metabolites in HMDB.
    - a log file (.txt).
]]>
    </help>

<expand macro="citations_rps" />
</tool>
	
