<tool id="MaREA RAS Generator" name="Expression2RAS" version="2.0.0">
    <description>- Reaction Activity Scores computation</description>
    <macros>
        <import>marea_macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="1.24.4">numpy</requirement>
        <requirement type="package" version="2.0.3">pandas</requirement>
        <requirement type="package" version="5.2.2">lxml</requirement>
		<requirement type="package" version="0.29.0">cobra</requirement>
	</requirements>
    <command detect_errors="exit_code">
        <![CDATA[
      	python $__tool_directory__/ras_generator.py
        --tool_dir $__tool_directory__
        --model_upload $model_upload
        --model_upload_name $model_upload.element_identifier
        --input $input
        --none $none

        --out_log $log
        --ras_output $ras_output
        
        ]]>
    </command>
    <inputs>
        <param name="model_upload" argument="--model_upload" type="data" format="csv,tsv,tabular" 
                label="Model tabular:" help="Upload the CSV/TSV file containing the information generated by the Import Metabolic Model tool." />
        <param name="input" argument="--input" type="data" format="tabular,csv,tsv" label="Gene Expression dataset:" />
        <param name="name" argument="--name" type="text" label="Dataset's name:" value="Dataset_RAS" 
                help="Default: Dataset_RAS. Do not use white spaces or special symbols." />
        <param name="none" argument="--none" type="boolean" checked="true" label="Ignore NaN in AND and OR expression?" /> 
    </inputs>

    <outputs>
        <data format="txt" name="log" label="Expression2RAS - $name - Log" />
        <data format="tabular" name="ras_output" label='$name'/>
    </outputs>

    <help>
<![CDATA[

Overview
-------------

This tool computes Reaction Activity Scores (RAS) from gene expression (RNA-seq) dataset(s), as described in Graudenzi et al. 2018.

The tool has four input parameters:
    - Metabolic model: tabular file containing information (reactionID and GPR) for RAS computation (see TIP 1)
    - Gene expression dataset: Tab-separated text file reporting the gene expression values (see TIP 2) 
    - Dataset name: choose the name of the ras expression dataset
    - Ignore NaN: if TRUE expression as (A and NaN) or (A or NaN) are solved as (A), if FALSE are solved as NaN. 
 
**TIP 1** The model tabular file can be the one obtained from Import Metabolic Model tool or can be a custom file BUT in the same format. 
 
**TIP 2** The dataset must the expression levels of each gene (row) for a given sample (column).  Column header: sample ID.
Row header: gene ID. All gene expression values must be positive (e.g. raw counts, TPM, or RPKM) to correctly compute the RAS. 



Example input
-------------

RNA-seq dataset:

+------------+----------------+----------------+----------------+ 
| Hugo_ID    |   TCGAA62670   |   TCGAA62671   |   TCGAA62672   |  
+============+================+================+================+
| HGNC:24086 |    0.523167    |    0.371355    |    0.925661    |  
+------------+----------------+----------------+----------------+    
| HGNC:24086 |    0.568765    |    0.765567    |    0.456789    |    
+------------+----------------+----------------+----------------+    
| HGNC:9876  |    0.876545    |    0.768933    |    0.987654    |  
+------------+----------------+----------------+----------------+
| HGNC:9     |    0.456788    |    0.876543    |    0.876542    |    
+------------+----------------+----------------+----------------+    
| HGNC:23    |    0.876543    |    0.786543    |    0.897654    |   
+------------+----------------+----------------+----------------+

]]>
    </help>
<expand macro="citations" />
</tool>
	

